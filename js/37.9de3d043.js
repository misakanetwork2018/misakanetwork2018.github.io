(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{"8f8e4":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"flex flex-center"},[a("div",{staticClass:"auth-form"},[a("h4",[t._v("重置密码")]),a("q-form",{staticClass:"q-gutter-md",on:{submit:t.onSubmit}},[a("q-input",{ref:"email",attrs:{filled:"",label:"邮箱","lazy-rules":"",rules:[function(t){return t&&t.length>0||"请输入邮箱"},function(e){return t.isEmail||"必须符合邮箱格式"},function(e){return!t.email_exist||"邮箱已被占用"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t.needV2?a("vue-recaptcha",{attrs:{sitekey:t.v2_key,loadRecaptchaScript:!0,recaptchaHost:"www.recaptcha.net"},on:{verify:t.onCaptchaVerify}}):t._e(),a("recaptcha-js-v3"),a("div",[a("q-btn",{attrs:{label:"请求重置密码",type:"submit",color:"primary",loading:t.doing,disable:t.doing}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"返回登录",color:"primary",flat:"",to:"/login"}})],1)],1)],1)])},i=[],c=(a("3b2b"),a("e096")),r={data:function(){return{email:"",needV2:!1,recaptcha_v2:null,doing:!1}},methods:{onCaptchaVerify:function(t){this.recaptcha_v2=t},onSubmit:function(){var t=this;this.doing=!0,grecaptcha.ready((function(){grecaptcha.execute(t.v3_key,{action:"login"}).then((function(e){t.$axios.post("/user/auth/password/reset/request",{email:t.email,"recaptcha-v3-token":e,"g-recaptcha-response":t.recaptcha_v2}).then((function(e){e.data.success?t.$q.dialog({title:"请求已收到",message:"系统已经给您发送一封重置密码确认邮件，请点击里面的链接前往密码重置界面"}):e.data?(e.data.needV2&&(t.needV2=!0),t.$q.notify({position:"top",message:e.data.msg})):t.$q.notify({position:"top",message:"未知错误，请重试"}),t.doing=!1})).catch((function(e){t.doing=!1}))}))}))}},components:{"recaptcha-js-v3":{render:function(t){return t("script",{attrs:{type:"text/javascript",src:"https://www.recaptcha.net/recaptcha/api.js?render="+window.appConfig.recaptcha.v3_sitekey}})}},VueRecaptcha:c["a"]},computed:{v3_key:function(){return window.appConfig.recaptcha.v3_sitekey},v2_key:function(){return window.appConfig.recaptcha.v2_sitekey},isEmail:function(){var t=new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");return t.test(this.email)}}},s=r,o=a("2877"),p=a("eebe"),l=a.n(p),u=a("9989"),d=a("0378"),f=a("27f9"),h=a("9c40"),m=Object(o["a"])(s,n,i,!1,null,null,null);e["default"]=m.exports;l()(m,"components",{QPage:u["a"],QForm:d["a"],QInput:f["a"],QBtn:h["a"]})}}]);