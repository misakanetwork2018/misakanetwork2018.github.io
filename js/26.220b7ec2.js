(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{b2d2:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[e.loaded?e._e():t("p",{staticClass:"q-mt-md"},[e._v(e._s(e.message))]),e.loaded?t("vue-qr",{attrs:{text:e.code,size:220}}):e._e()],1)},s=[],n=(t("c5f6"),t("658f")),r=t.n(n),o={props:{invoice:{type:Number,required:!1},amount:{type:Number,required:!1}},data:function(){return{loaded:!1,code:"",trade_no:"",message:"正在获取付款二维码",query_inv:null}},created:function(){this.refresh(),this.query_inv=setInterval(this.alipayQuery,5e3)},methods:{refresh:function(){var e=this;this.$axios.post("/pay/create",{invoice_id:this.invoice,amount:this.amount,gateway:"alipay"}).then((function(a){var t=a.data;t.success?(e.code=t.data.qrcode,e.trade_no=t.data.trade_no,e.loaded=!0):e.message="获取支付二维码失败，请刷新重试..."})).catch((function(){e.message="获取支付二维码失败，请刷新重试..."}))},alipayQuery:function(){var e=this;this.$axios.get("/pay/alipay_query?trade_no="+this.trade_no).then((function(a){switch(a.data){case"TRADE_SUCCESS":case"TRADE_FINISHED":clearInterval(e.query_inv),e.$emit("finish"),e.$q.dialog({title:"通知",message:"支付已完成"});break;case"TRADE_CLOSED":clearInterval(e.query_inv),e.$emit("finish"),e.$q.dialog({title:"警告",message:"支付已关闭"}),e.message="支付已关闭";break}}))}},components:{vueQr:r.a}},c=o,d=t("2877"),u=Object(d["a"])(c,i,s,!1,null,"70f5fb36",null);a["default"]=u.exports}}]);