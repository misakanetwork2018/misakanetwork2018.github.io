(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[46],{d2a9:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"q-pa-md row items-start q-gutter-sm"},[a("div",{staticClass:"col-12 col-md"},[a("q-card",{staticClass:"my-card"},[a("q-card-section",[t._v("\n        密码修改\n      ")]),a("q-separator"),a("q-card-section",[a("q-form",{staticClass:"q-gutter-md",on:{submit:function(s){return t.onSubmit("password")},reset:function(s){return t.onReset("password")}}},[a("q-input",{ref:"old_password",attrs:{filled:"",type:"password",label:"旧密码","lazy-rules":"",rules:[function(t){return t&&t.length>0||"请输入密码"},function(s){return!t.wrong_old_pwd||"旧密码不正确"}],dense:""},on:{input:function(s){t.wrong_old_pwd=!1}},model:{value:t.old_password,callback:function(s){t.old_password=s},expression:"old_password"}}),a("q-input",{attrs:{filled:"",type:"password",label:"新密码","lazy-rules":"",rules:[function(t){return t&&t.length>=6&&t.length<=30||"请输入6-30位密码"},function(s){return t.notOldPwd||"新密码不能与旧密码相同"}],dense:""},on:{input:function(s){!t.password_confirm||t.$refs.confirm.validate()}},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}}),a("q-input",{ref:"confirm",attrs:{filled:"",type:"password",label:"确认密码","lazy-rules":"",rules:[function(t){return t&&t.length>0||"请输入确认密码"},function(s){return t.passwordConfirm||"密码与确认密码不相符"}],dense:""},model:{value:t.password_confirm,callback:function(s){t.password_confirm=s},expression:"password_confirm"}}),a("div",[a("q-btn",{attrs:{label:"提交",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"重置",type:"reset",color:"primary",flat:""}})],1)],1)],1)],1)],1),a("div",{staticClass:"col-12 col-md"},[a("q-card",{staticClass:"my-card"},[a("q-card-section",[t._v("\n        其他信息维护\n      ")]),a("q-separator"),a("q-card-section",[a("q-form",{staticClass:"q-gutter-md",on:{submit:function(s){return t.onSubmit("other")},reset:function(s){return t.onReset("other")}}},[a("q-input",{ref:"email",attrs:{filled:"",label:"邮箱","lazy-rules":"",dense:"",rules:[function(t){return t&&t.length>0||"请输入邮箱"},function(s){return t.isEmail||"必须符合邮箱格式"},function(s){return!t.email_exist||"邮箱已被占用"}]},on:{input:function(s){t.email_exist=!1}},model:{value:t.data.email,callback:function(s){t.$set(t.data,"email",s)},expression:"data.email"}}),a("q-input",{attrs:{filled:"",label:"API KEY",dense:""},model:{value:t.data.api_key,callback:function(s){t.$set(t.data,"api_key",s)},expression:"data.api_key"}}),a("q-checkbox",{attrs:{label:"出账时优先使用余额"},model:{value:t.data.use_credit,callback:function(s){t.$set(t.data,"use_credit",s)},expression:"data.use_credit"}}),a("div",[a("q-btn",{attrs:{label:"提交",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"重置",type:"reset",color:"primary",flat:""}})],1)],1)],1)],1)],1)])},r=[],n=(a("3b2b"),a("f751"),{data:function(){return{old_password:"",password:"",password_confirm:"",wrong_old_pwd:!1,data:{email:"",api_key:"",use_credit:!1},origin:{email:"",api_key:""},email_exist:!1}},created:function(){var t=this;this.$axios.get("/user/info").then((function(s){Object.assign(t.data,s.data),Object.assign(t.origin,s.data)}))},methods:{onSubmit:function(t){var s=this;switch(t){case"password":this.$axios.post("/user/info/password",{old:this.old_password,new:this.password}).then((function(t){t.data.success?s.$q.notify({color:"positive",message:"修改成功"}):t.data.wrong_pwd?(s.wrong_old_pwd=!0,s.$refs.old_password.validate()):s.$q.notify({color:"warning",message:"未知错误"})}));break;case"other":this.$axios.post("/user/info",this.data).then((function(t){t.data.success?(s.$q.notify({color:"positive",message:"修改成功"}),Object.assign(s.origin,s.data)):t.data.email_exist?(s.email_exist=!0,s.$refs.email.validate()):s.$q.notify({color:"warning",message:"未知错误"})}));break}},onReset:function(t){switch(t){case"password":this.password="",this.old_password="",this.password_confirm="";break;case"other":Object.assign(this.data,this.origin);break}}},components:{},computed:{passwordConfirm:function(){return this.password===this.password_confirm},notOldPwd:function(){return this.old_password!==this.password},isEmail:function(){var t=new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");return t.test(this.data.email)}}}),o=n,i=a("2877"),l=a("eebe"),d=a.n(l),c=a("f09f"),u=a("a370"),p=a("eb85"),f=a("0378"),m=a("27f9"),w=a("9c40"),b=a("8f8e"),_=Object(i["a"])(o,e,r,!1,null,"36b298a4",null);s["default"]=_.exports;d()(_,"components",{QCard:c["a"],QCardSection:u["a"],QSeparator:p["a"],QForm:f["a"],QInput:m["a"],QBtn:w["a"],QCheckbox:b["a"]})}}]);