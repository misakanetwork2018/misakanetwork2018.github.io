(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{b2d2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.loaded?e._e():a("p",{staticClass:"q-mt-md"},[e._v(e._s(e.message))]),e.loaded?a("vue-qr",{attrs:{text:e.code,size:220}}):e._e()],1)},n=[],s=(a("c5f6"),a("658f")),r=a.n(s),o={props:{invoice:{type:Number,required:!1},amount:{type:Number,required:!1}},data:function(){return{loaded:!1,code:"",trade_no:"",message:"正在获取付款二维码",query_inv:null}},created:function(){this.refresh()},destroyed:function(){clearInterval(this.query_inv)},methods:{refresh:function(){var e=this;this.$axios.post("/pay/create",{invoice_id:this.invoice,amount:this.amount,gateway:"alipay"}).then((function(t){var a=t.data;a.success?(e.code=a.data.qrcode,e.trade_no=a.data.trade_no,e.loaded=!0,e.query_inv=setInterval(e.alipayQuery,5e3)):e.message="获取支付二维码失败，请刷新重试..."})).catch((function(){e.message="获取支付二维码失败，请刷新重试..."}))},alipayQuery:function(){var e=this;this.$axios.get("/pay/alipay_query?trade_no="+this.trade_no).then((function(t){switch(t.data){case"TRADE_SUCCESS":case"TRADE_FINISHED":clearInterval(e.query_inv),setTimeout((function(){e.$emit("finish")}),1e3),e.$q.dialog({title:"通知",message:"支付已完成"});break;case"TRADE_CLOSED":clearInterval(e.query_inv),e.$emit("finish"),e.$q.dialog({title:"警告",message:"支付已关闭"}),e.message="支付已关闭";break}}))}},components:{vueQr:r.a}},c=o,d=a("2877"),u=Object(d["a"])(c,i,n,!1,null,"506187cd",null);t["default"]=u.exports}}]);